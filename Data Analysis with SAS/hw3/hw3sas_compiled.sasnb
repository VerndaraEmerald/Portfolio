[{"kind":1,"language":"markdown","value":"EX 1","outputs":[]},{"kind":2,"language":"sas","value":"data docvisits;\r\n    input patientID$ 1-4 weekday$5-15 score;\r\n  cards;\r\n 101  Friday    15\r\n 163  Wednesday 11\r\n 104  Friday    23\r\n 163  Thursday  13\r\n 123  Tuesday   10\r\n 104  Monday    20\r\n 157  Friday    21\r\n 101  Monday    10\r\n 112  Tuesday   11\r\n 157  Tuesday   10\r\n 123  Monday    9\r\n 123  Friday    9\r\n 101  Tuesday   11\r\n 112  Monday    9\r\n 157  Thursday  18\r\n 174  Monday    12\r\n ;","outputs":[]},{"kind":2,"language":"sas","value":" \r\ntitle 'Amount of patients';\r\nproc sql;\r\n    SELECT count(distinct(patientID)) AS amount_patients\r\n    FROM docvisits;\r\nquit;","outputs":[]},{"kind":2,"language":"sas","value":"title 'Total number of visits per patient';\r\nproc sql;\r\n    SELECT patientID, \r\n    count(patientID) as patient\r\n    FROM docvisits\r\n    GROUP BY (patientID);\r\nquit;","outputs":[]},{"kind":2,"language":"sas","value":"title 'Per-day amount of visits';\r\nproc sql;\r\n    SELECT weekday, \r\n    count(patientID) as day_patients \r\n    FROM docvisits\r\n    GROUP weekday\r\n    ORDER BY\r\n        CASE \r\n            WHEN weekday = \"Monday\" THEN 1\r\n            WHEN weekday = \"Tuesday\" THEN 2\r\n            WHEN weekday = \"Wednesday\" THEN 3\r\n            WHEN weekday = \"Thursday\" THEN 4\r\n            WHEN weekday = \"Friday\" THEN 5\r\n        END ASC;\r\nquit;","outputs":[]},{"kind":1,"language":"markdown","value":"EX 2","outputs":[]},{"kind":2,"language":"sas","value":"data record;\r\n    input ID$ Gender$ Age Score;\r\n    cards;\r\n    259632  F  56  58\r\n    259632  F  56  41\r\n    259632  F  56  39\r\n    577763  F  67  40\r\n    577763  F  67  50\r\n    577763  F  67  39\r\n    577763  F  67  33\r\n    279645  M  52  24\r\n    279645  M  52  65\r\n    279645  M  52  66\r\n    279645  M  52  74\r\n    279645  M  52  85\r\n    694797  F  48  37\r\n    694797  F  48  85\r\n    684516  M  57  81\r\n    760076  M  62  45\r\n    760076  M  62  35\r\n    760076  M  62  38\r\n    760076  M  62  65\r\n    745795  F  74  85\r\n    745795  F  74  82\r\n    745795  F  74  77\r\n    745795  F  74  81\r\n    506301  M  78  70\r\n    506301  M  78  70\r\n    506301  M  78  71\r\n    506301  M  78  67\r\n    406126  M  62  60\r\n    406126  M  62  50\r\n    477908  M  70  50\r\n    477908  M  70  63\r\n    477908  M  70  51\r\n    188994  F  58  43\r\n    188994  F  58  34\r\nrun;\r\n","outputs":[]},{"kind":2,"language":"sas","value":"title 'Amount of patients';\r\nproc sql;\r\n    SELECT count(DISTINCT(ID)) AS amount\r\n    FROM record\r\nquit;","outputs":[]},{"kind":2,"language":"sas","value":"title 'Amount of patients by gender';\r\nproc sql;\r\n    SELECT Gender, \r\n        count(DISTINCT(ID)) AS amount\r\n    FROM record\r\n    GROUP Gender;\r\nquit;\r\n","outputs":[]},{"kind":2,"language":"sas","value":"title 'Number of patients older than 62';\r\nproc sql;\r\n    SELECT count(DISTINCT(ID)) AS patients\r\n    FROM record\r\n    WHERE Age > 62;\r\nquit;\r\n","outputs":[]},{"kind":2,"language":"sas","value":"title 'Number of female patients older than 62';\r\nproc sql;\r\n    SELECT count(DISTINCT(ID)) AS patients\r\n    FROM record\r\n    WHERE Age > 62 AND Gender = \"F\";\r\nquit;\r\n","outputs":[]},{"kind":2,"language":"sas","value":"title 'Amount of visits by patient ID'; \r\nproc sql;\r\n    SELECT ID, \r\n        count(ID) AS n_visits\r\n    FROM record\r\n    GROUP BY ID;\r\nquit;\r\n","outputs":[]},{"kind":2,"language":"sas","value":"title 'Amount of visits by patient ID where score > 45';\r\nproc sql;\r\n    SELECT ID, \r\n        count(ID) AS n_visits\r\n    FROM record\r\n    WHERE Score > 45\r\n    GROUP BY ID;\r\nquit;\r\n","outputs":[]},{"kind":2,"language":"sas","value":"title 'Minimum, average, and maximum scores per patient';\r\nproc sql;\r\n    SELECT ID,\r\n        min(Score) as Minimum,\r\n        mean(Score) as Average,\r\n        max(Score) as Maximum\r\n    FROM record\r\n    GROUP BY ID;\r\nquit;\r\n","outputs":[]},{"kind":2,"language":"sas","value":"title 'Patients with average scores > 60';\r\nproc sql;\r\n    SELECT ID\r\n    FROM record\r\n    GROUP BY ID\r\n    HAVING mean(Score) > 60;\r\nquit;","outputs":[]},{"kind":1,"language":"markdown","value":"EX 3","outputs":[]},{"kind":2,"language":"sas","value":"data TSLA;\r\ninput date mmddyy10. open close;\r\ncards;\r\n12/30/2021 1061.32 1070.33\r\n12/31/2021 1073.43 1056.78\r\n1/3/2022   1147.75 1199.78\r\n1/4/2022   1189.55 1149.58\r\n1/5/2022   1146.65 1088.11\r\n1/6/2022   1077.00 1064.69\r\n1/7/2022   1080.36 1026.95\r\n1/10/2022  1000.00 1058.11\r\n1/11/2022  1053.67 1064.40\r\n;\r\n    \r\ndata AMZN;\r\ninput date mmddyy10. open close;\r\ncards;\r\n12/23/2021 3408.56 3421.37\r\n12/27/2021 3420.73 3393.38\r\n12/28/2021 3403.64 3413.21\r\n12/29/2021 3416.80 3384.02\r\n12/30/2021 3394.00 3372.88\r\n12/31/2021 3379.12 3334.34\r\n1/3/2022   3351.00 3408.09\r\n1/4/2022   3408.76 3350.44\r\n; \r\n","outputs":[]},{"kind":2,"language":"sas","value":"title 'Inner join';\r\nproc sql;\r\n    SELECT TSLA.date as date format = mmddyy8., \r\n        TSLA.open, \r\n        TSLA.close, \r\n        AMZN.open, \r\n        AMZN.close\r\n    FROM TSLA, AMZN\r\n    WHERE TSLA.date = AMZN.date;\r\nquit;","outputs":[]},{"kind":2,"language":"sas","value":"title 'Left join';\r\nproc sql;\r\n    SELECT TSLA.date as date format = mmddyy8., \r\n        TSLA.open, \r\n        TSLA.close, \r\n        AMZN.open, \r\n        AMZN.close\r\n    FROM TSLA\r\n    LEFT JOIN AMZN\r\n        ON TSLA.date = AMZN.date;\r\nquit;","outputs":[]},{"kind":2,"language":"sas","value":"title 'Right join';\r\nproc sql;\r\n    SELECT AMZN.date as date format = mmddyy8., \r\n        TSLA.open, \r\n        TSLA.close, \r\n        AMZN.open, \r\n        AMZN.close\r\n    FROM TSLA\r\n    RIGHT JOIN AMZN\r\n        ON TSLA.date = AMZN.date;\r\nquit;","outputs":[]},{"kind":2,"language":"sas","value":"title 'Full join';\r\nproc sql;\r\n    SELECT TSLA.date as date format = mmddyy8., \r\n        TSLA.open, \r\n        TSLA.close, \r\n        AMZN.date as date format = mmddyy8., \r\n        AMZN.open, \r\n        AMZN.close\r\n    FROM TSLA\r\n    FULL JOIN AMZN\r\n        ON TSLA.date = AMZN.date;\r\nquit;","outputs":[]},{"kind":1,"language":"markdown","value":"EX 4","outputs":[]},{"kind":2,"language":"sas","value":"data BTC1;\r\ninput date mmddyy10. open close;\r\ncards;\r\n12/28/2021 50679.85 47588.85\r\n12/29/2021 47623.87 46444.71\r\n12/30/2021 46490.60 47178.12\r\n12/31/2021 47169.37 46306.44\r\n1/1/2022   46311.74 47686.81\r\n1/2/2022   47680.92 47345.21\r\n1/3/2022   47343.54 46458.11\r\n1/4/2022   46458.85 45897.57\r\n;\r\n\r\ndata BTC2;\r\ninput date mmddyy10. open close;\r\ncards;\r\n12/31/2021 47169.37 46306.44\r\n1/1/2022   46311.74 47686.81\r\n1/2/2022   47680.92 47345.21\r\n1/3/2022   47343.54 46458.11\r\n1/4/2022   46458.85 45897.57\r\n1/5/2022   45899.35 43569.00\r\n1/6/2022   43565.51 43160.92\r\n1/7/2022   43153.57 41557.90\r\n;","outputs":[]},{"kind":2,"language":"sas","value":"title 'BTC1 not in BTC2 via except';\r\nproc sql;\r\n    SELECT date as date format = mmddyy8., open, close\r\n    FROM BTC1\r\n    except \r\n    SELECT date as date format = mmddyy8., open, close\r\n    FROM BTC2;\r\nquit;","outputs":[]},{"kind":2,"language":"sas","value":"title 'BTC2 not in BTC1 via except';\r\nproc sql;\r\n    SELECT date as date format = mmddyy8., open, close\r\n    FROM BTC2\r\n    except \r\n    SELECT date as date format = mmddyy8., open, close\r\n    FROM BTC1;\r\nquit;","outputs":[]},{"kind":2,"language":"sas","value":"title 'BTC1 and BTC2 via intersect';\r\nproc sql;\r\n    SELECT date as date format = mmddyy8., open, close\r\n    FROM BTC1\r\n    intersect \r\n    SELECT date as date format = mmddyy8., open, close\r\n    FROM BTC2;\r\nquit;","outputs":[]},{"kind":2,"language":"sas","value":"title 'BTC1 and BTC2 via union';\r\nproc sql;\r\n    SELECT date as date format = mmddyy8., open, close\r\n    FROM BTC1\r\n    union \r\n    SELECT date as date format = mmddyy8., open, close\r\n    FROM BTC2;\r\nquit;","outputs":[]},{"kind":2,"language":"sas","value":"title 'BTC1 and BTC2 via outer union';\r\nproc sql;\r\n    SELECT date as date format = mmddyy8., open, close\r\n    FROM BTC1\r\n    outer union \r\n    SELECT date as date format = mmddyy8., open, close\r\n    FROM BTC2;\r\nquit;","outputs":[]}]