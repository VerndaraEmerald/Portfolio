[{"kind":2,"language":"sas","value":"Options syntaxcheck=0 obs=MAX;","outputs":[]},{"kind":1,"language":"markdown","value":"Call data.","outputs":[]},{"kind":2,"language":"sas","value":"/* Call data. */\r\ndata accidents;\r\n infile 'C:\\Users\\3sekk\\Desktop\\Portfolio\\Applied Regression Analysis\\Data\\Exercise5.2Data.csv' dlm=',' firstobs = 2;\r\n input naccidents gender$ age miles;\r\nrun; ","outputs":[]},{"kind":1,"language":"markdown","value":"Run model.","outputs":[]},{"kind":2,"language":"sas","value":"/* Run model. */\r\nODS output ModelFit=ModelFit;\r\nODS output ParameterEstimates=ParameterEstimates;\r\nproc genmod;\r\n    class gender(ref=\"F\");\r\n    model naccidents = gender age miles / dist=poisson link=log;\r\n    ODS select ModelFit;\r\n    ODS select ParameterEstimates;\r\nrun;\r\n\r\n/* Copy log likelihood from general model's ModelFit. */\r\ndata _null_;\r\n    set ModelFit;\r\n    if Criterion=\"Log Likelihood\" then call symputx(\"FittedLogLike\", Value);\r\nrun;\r\n%put LogLike = &FittedLogLike;\r\n\r\n/* Calculates degrees of freedom for deviance testing. Counts rows from ParameterEstimates with DF = 1.*/\r\nproc sql noprint;\r\n    SELECT (count(DF))-1 into :Rows \r\n    FROM ParameterEstimates \r\n    WHERE DF = 1;\r\n    quit;\r\nrun;\r\n%put Rows = &Rows;\r\n\r\n/* Outputs ParameterEstimates to a file for Python to write out a regression analysis. */\r\noptions nosource nonotes;\r\nproc export data=ParameterEstimates\r\n    outfile = \"C:\\Users\\3sekk\\Desktop\\Portfolio\\Applied Regression Analysis\\temp outputs/text.csv\"\r\n    dbms = csv replace;\r\n    DELIMITER = ',';\r\nrun;\r\noptions source notes;","outputs":[]},{"kind":1,"language":"markdown","value":"Null model.","outputs":[]},{"kind":2,"language":"sas","value":"/* Null model. */\r\nODS output ModelFit=ModelFit;\r\nODS output ParameterEstimates=ParameterEstimates;\r\nproc genmod data = accidents;\r\nmodel naccidents = / dist=poisson link=log;\r\nODS select ModelFit;\r\nODS select ParameterEstimates;\r\nrun;\r\n\r\n/* Copy log likelihood from null model's ModelFit. */\r\ndata _null_;\r\nset ModelFit;\r\nif Criterion=\"Log Likelihood\" then call symputx(\"NullLogLike\", Value);\r\nrun;\r\n%put LogLike = &NullLogLike;","outputs":[]},{"kind":1,"language":"markdown","value":"Deviance test.","outputs":[]},{"kind":2,"language":"sas","value":"/* Deviance test via macros. */\r\ndata deviance_test;\r\ndeviance=-2*(&NullLogLike-(&FittedLogLike));\r\npvalue=1-probchi(deviance,&Rows);\r\nrun;\r\nproc print noobs;\r\nrun;","outputs":[]},{"kind":1,"language":"markdown","value":"Prediction.","outputs":[]},{"kind":2,"language":"sas","value":"/* Prediction */\r\ndata predict;\r\ninput gender$ age miles;\r\ncards;\r\nF 35 100\r\n;\r\n\r\ndata accidents;\r\nset accidents predict;\r\nrun;","outputs":[]},{"kind":2,"language":"sas","value":"/* Perform prediction without printing. */\r\nods select none;\r\nproc genmod;\r\nclass gender(ref=\"F\");\r\nmodel naccidents = gender age miles / dist=poisson link=log;\r\noutput out=outdata p=pnaccidents;\r\nrun;\r\nods select all;\r\n\r\n/* Acquire the final row. */\r\nproc sql noprint;\r\n select (count(*)) into :Rows from outdata;\r\n quit;\r\nrun;\r\n%put Rows = &Rows;","outputs":[]},{"kind":2,"language":"sas","value":"/* Output prediction. */\r\nproc print data=outdata (firstobs=&Rows) noobs;\r\nvar pnaccidents;\r\nrun; ","outputs":[]}]